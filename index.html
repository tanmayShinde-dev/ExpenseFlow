<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#64ffda">
    <meta name="description" content="Take control of your finances with our intuitive expense tracker">
    <meta name="keywords" content="expense tracker, budget, finance, money management, PWA">
    <meta name="author" content="ExpenseFlow">

    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ExpenseFlow">
    <meta name="msapplication-TileColor" content="#0f0f23">
    <meta name="msapplication-navbutton-color" content="#64ffda">
    
    <!-- Removed manifest to fix 404 error -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iNDIiIGZpbGw9InVybCgjZ3JhZGllbnQwX2xpbmVhclswXSkiLz4KPHBhdGggZD0iTTQ4IDY0SDQ4LjA0OEgxNDRWMTI4SDk2VjE0NEgxNDRDMTUyLjgzNyAxNDQgMTYwIDEzNi44MzcgMTYwIDEyOFY2NEM1OCA1Ni4xNjMgNTIuMDQzIDQ4IDQ4IEg0OEM0MC4wNzEgNDggMzIgNTYuMDcxIDMyIDY0VjEyOEMzMiAxMzUuOTI5IDQwLjA3MSAxNDQgNDggMTQ0SDgwVjEyOEg0OFY2NFoiIGZpbGw9IiM2NGZmZGEiLz4KPHBhdGggZD0iTTY0IDgwSDgwVjk2SDY0VjgwWiIgZmlsbD0iIzY0ZmZkYSIvPgo8cGF0aCBkPSJNOTYgODBIMTI4Vjk2SDk2VjgwWiIgZmlsbD0iIzY0ZmZkYSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDBfbGluZWFyWzBdIiB4MT0iMCIgeTE9IjAiIHgyPSIxOTIiIHkyPSIxOTIiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzY2N2VlYSIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM3NjRiYTIiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K">
    
    <title>ExpenseFlow - Smart Money Management</title>
    <link rel="stylesheet" href="expensetracker.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

</head>
<body>

  <!-- Main Content -->
  <main class="main-content">
    <div class="hero-section glass">
      <h1 class="hero-title">Smart Money Management</h1>
      <p class="hero-subtitle">Take control of your finances with our intuitive expense tracker</p>
    </div>

<div class="cursor-trail-container" id="cursor-trail"></div>

<script>
(function() {
  // Hide default cursor
  document.body.style.cursor = 'none';
  
  const container = document.getElementById('cursor-trail');
  const coords = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
  const trailCircles = [];
  const COUNT = 12; // Fewer circles for smoother trail
  
  // Create trail circles
  for (let i = 0; i < COUNT; i++) {
    const circle = document.createElement('div');
    circle.className = 'trail-dot';
    
    // Opacity decreases along the trail
    const opacity = 0.9 - (i / COUNT) * 0.8;
    circle.style.opacity = opacity.toString();
    
    // Size decreases along the trail
    const scale = 1 - (i / COUNT) * 0.5;
    circle.style.transform = `translate(-50%, -50%) scale(${scale})`;
    
    container.appendChild(circle);
    trailCircles.push({ 
      element: circle, 
      x: coords.x, 
      y: coords.y,
      targetX: coords.x,
      targetY: coords.y
    });
  }
  
  // Track mouse position
  let isMoving = false;
  let lastMouseX = coords.x;
  let lastMouseY = coords.y;
  let velocity = { x: 0, y: 0 };
  
  window.addEventListener('mousemove', e => {
    coords.x = e.clientX;
    coords.y = e.clientY;
    
    // Calculate velocity for smooth movement
    velocity.x = e.clientX - lastMouseX;
    velocity.y = e.clientY - lastMouseY;
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
    
    isMoving = true;
    
    // Reset movement timeout
    clearTimeout(window.movementTimeout);
    window.movementTimeout = setTimeout(() => {
      isMoving = false;
    }, 50);
  });
  
  // Click effect
  window.addEventListener('mousedown', () => {
    trailCircles.forEach(circle => {
      circle.element.classList.add('cursor-clicking');
    });
  });
  
  window.addEventListener('mouseup', () => {
    trailCircles.forEach(circle => {
      circle.element.classList.remove('cursor-clicking');
    });
  });
  
  // Hover effect for interactive elements
  window.addEventListener('mouseover', e => {
    const interactive = e.target.closest('a, button, input, select, textarea, [role="button"]');
    trailCircles.forEach(circle => {
      circle.element.classList.toggle('cursor-hovering', !!interactive);
    });
  });
  
  // Smooth animation function
  function animateTrail() {
    let targetX = coords.x;
    let targetY = coords.y;
    
    // Add velocity offset to first circle for more natural feel
    const velocityOffset = 0.5;
    const offsetX = velocity.x * velocityOffset;
    const offsetY = velocity.y * velocityOffset;
    
    trailCircles.forEach((circle, index) => {
      // First circle follows cursor exactly
      if (index === 0) {
        circle.x = targetX + offsetX;
        circle.y = targetY + offsetY;
      } 
      // Other circles follow with smooth delay
      else {
        const prevCircle = trailCircles[index - 1];
        
        // Smooth interpolation factor (changes based on movement speed)
        const speed = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);
        const lerpFactor = isMoving ? 
          Math.min(0.3 + (speed * 0.01), 0.5) :  // Faster movement = tighter trail
          0.1; // Slow movement = more spread
        
        circle.x += (prevCircle.x - circle.x) * lerpFactor;
        circle.y += (prevCircle.y - circle.y) * lerpFactor;
      }
      
      // Apply position with easing
      circle.element.style.left = circle.x + 'px';
      circle.element.style.top = circle.y + 'px';
      
      // Dynamic opacity based on speed and position
      if (index > 0) {
        const speed = Math.sqrt(velocity.x * velocity.x + velocity.y * velocity.y);
        const baseOpacity = 0.9 - (index / COUNT) * 0.8;
        const speedMultiplier = Math.min(1 + speed * 0.02, 1.5);
        circle.element.style.opacity = (baseOpacity * speedMultiplier).toString();
      }
      
      // Update target for next circle
      targetX = circle.x;
      targetY = circle.y;
    });
    
    requestAnimationFrame(animateTrail);
  }
  
  // Handle window resize
  window.addEventListener('resize', () => {
    // Adjust if cursor goes out of bounds
    if (coords.x > window.innerWidth) coords.x = window.innerWidth;
    if (coords.y > window.innerHeight) coords.y = window.innerHeight;
  });
  
  // Handle mouse leave/enter
  window.addEventListener('mouseleave', () => {
    trailCircles.forEach(circle => {
      circle.element.style.opacity = '0';
    });
  });
  
  window.addEventListener('mouseenter', () => {
    trailCircles.forEach((circle, index) => {
      const opacity = 0.9 - (index / COUNT) * 0.8;
      circle.element.style.opacity = opacity.toString();
    });
  });
  
  // Start animation
  animateTrail();
})();
</script>

      
    <!-- Global Loader -->
<div id="global-loader" class="global-loader hidden">
  <div class="spinner"></div>
</div>

  <!-- Protected Content Wrapper -->
  <div id="protectedContent" class="protected-content">
    <!-- Header -->
    <header class="header">
      <nav class="navbar">
        <div class="nav-container">
          <a href="#" class="nav-logo">
            <i class="fas fa-wallet"></i>
            <span>ExpenseFlow</span>
          </a>
          <div class="nav-menu" id="nav-menu">
            <a href="#dashboard" class="nav-link active">Dashboard</a>
            <a href="analytics.html" class="nav-link">Analytics</a>
            <a href="public/analytics.html" class="nav-link">Analytics</a>
            <a href="#analytics" class="nav-link">Analytics</a>
            <a href="#health" class="nav-link" id="health-tab">Health</a>
            <a href="#goals" class="nav-link">Goals</a>
            <a href="#settings" class="nav-link">Settings</a>
            <a href="javascript:void(0)" class="nav-link" onclick="openLoginModal()">Login</a>
          </div>
          
          <div class="nav-actions">
            <div class="nav-search">
              <i class="fas fa-search"></i>
              <input type="text" placeholder="Search transactions...">
            </div>
            <button class="nav-icon-btn" title="Notifications">
              <i class="fas fa-bell"></i>
              <span class="notification-badge">2</span>
            </button>
          </div>
          <div class="nav-toggle" id="nav-toggle">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
            <span><a href="index.html" class="nav-link">ExpenseFlow</a></span>
          </div>
          <div class="card-content">
            <h4>Income</h4>
            <p id="money-plus" class="money-plus">
              +&#8377;0.00
            </p>
          </div>
        </div>
        <div class="expense-card">
          <div class="card-icon expense-icon">
            <i class="fas fa-arrow-down"></i>
          </div>
          <button id="theme-toggle-btn" class="theme-toggle-btn dark-mode" title="Switch to Light Mode">
            <i class="fas fa-sun"></i>
          </button>
          <div class="user-profile">
            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=50&h=50&fit=crop&crop=face" alt="User" class="profile-img">
            <span class="username" id="navUsername">User</span>
            <div id="userInfo" class="user-info" style="display: none;">
              <button class="auth-btn logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
              </button>
            </div>
            </div>
          <div class="card-content">
            <h4>Expense</h4>
            <p id="money-minus" class="money-minus">
              -&#8377;0.00
            </p>
          </div>
        </div>
      </div>
    </nav>
  </header>

      <!-- Transaction History -->
      <div class="history-section">
        <div class="section-header">
          <h3><i class="fas fa-history"></i> Transaction History</h3>
          <div class="filter-controls">
            <div class="search-container">
              <input type="text" id="search-input" placeholder="Search transactions..." class="search-input">
              <i class="fas fa-search search-icon"></i>
            </div>
            <div class="filter-buttons">
              <button class="filter-btn active" data-filter="all">All</button>
              <button class="filter-btn" data-filter="income">Income</button>
              <button class="filter-btn" data-filter="expense">Expense</button>
            </div>
            <div class="advanced-filters">
              <select id="category-filter" class="category-select">
                <option value="all">All Categories</option>
                <option value="food">ğŸ½ï¸ Food & Dining</option>
                <option value="transport">ğŸš— Transportation</option>
                <option value="shopping">ğŸ›’ Shopping</option>
                <option value="entertainment">ğŸ¬ Entertainment</option>
                <option value="bills">ğŸ’¡ Bills & Utilities</option>
                <option value="healthcare">ğŸ¥ Healthcare</option>
                <option value="education">ğŸ“š Education</option>
                <option value="travel">âœˆï¸ Travel</option>
                <option value="salary">ğŸ’¼ Salary</option>
                <option value="freelance">ğŸ’» Freelance</option>
                <option value="investment">ğŸ“ˆ Investment</option>
                <option value="other">ğŸ“‹ Other</option>
              </select>
              <div class="date-filters">
                <input type="date" id="date-from" class="date-input" placeholder="From">
                <input type="date" id="date-to" class="date-input" placeholder="To">
              </div>
              <div class="amount-filters">
                <input type="number" id="amount-min" placeholder="Min Amount" class="amount-input" step="0.01">
                <input type="number" id="amount-max" placeholder="Max Amount" class="amount-input" step="0.01">
              </div>
              <button class="clear-filters-btn" id="clear-filters">
                <i class="fas fa-times"></i> Clear Filters
              </button>
            </div>
          </div>
        </div>
        <ul id="list" class="list">
          <!-- Transactions will be added here -->
        </ul>
      </div>

      <!-- Data Management Section -->
      <div class="data-management-section">
        <h3><i class="fas fa-database"></i> Data Management</h3>
        <div class="data-actions">
          <div class="export-section">
            <h4>Export Data</h4>
            <div class="export-buttons">
              <button class="export-btn" id="export-csv">
                <i class="fas fa-file-csv"></i> Quick CSV
              </button>
              <button class="export-btn pdf-btn" id="export-pdf">
                <i class="fas fa-file-pdf"></i> Quick PDF
              </button>
              <button class="export-btn advanced-btn" id="open-export-modal">
                <i class="fas fa-cog"></i> Advanced Export
              </button>
            </div>
          </div>
          <div class="import-section">
            <h4>Import Data</h4>
            <div class="import-controls">
              <input type="file" id="import-file" accept=".csv,.json" class="file-input">
              <label for="import-file" class="file-label">
                <i class="fas fa-upload"></i> Choose File
              </label>
              <button class="import-btn" id="import-data" disabled>
                <i class="fas fa-download"></i> Import Data
              </button>
            </div>
            <div class="import-options">
              <label class="checkbox-label">
                <input type="checkbox" id="merge-data" checked>
                <span class="checkmark"></span>
                Merge with existing data
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Export Modal -->
      <div class="export-modal" id="export-modal">
        <div class="export-modal-content">
          <div class="export-modal-header">
            <h3><i class="fas fa-download"></i> Export Expenses</h3>
            <button class="modal-close-btn" id="export-modal-close">
              <i class="fas fa-times"></i>
            </button>
          </div>

          <div class="export-modal-body">
            <!-- Format Selection -->
            <div class="export-format-section">
              <h4>Export Format</h4>
              <div class="format-options">
                <label class="format-option">
                  <input type="radio" name="export-format" id="export-format" value="csv" checked>
                  <div class="format-card">
                    <i class="fas fa-file-csv"></i>
                    <span class="format-name">CSV</span>
                    <span class="format-desc">Excel compatible</span>
                  </div>
                </label>
                <label class="format-option">
                  <input type="radio" name="export-format" value="pdf">
                  <div class="format-card">
                    <i class="fas fa-file-pdf"></i>
                    <span class="format-name">PDF Report</span>
                    <span class="format-desc">With charts & summary</span>
                  </div>
                </label>
              </div>
            </div>

            <!-- Filters -->
            <div class="export-filters-section">
              <h4>Filter Options</h4>
              <div class="filter-grid">
                <div class="form-control">
                  <label for="export-start-date">Start Date</label>
                  <input type="date" id="export-start-date">
                </div>
                <div class="form-control">
                  <label for="export-end-date">End Date</label>
                  <input type="date" id="export-end-date">
                </div>
                <div class="form-control">
                  <label for="export-category-filter">Category</label>
                  <select id="export-category-filter">
                    <option value="all">All Categories</option>
                    <option value="food">ğŸ½ï¸ Food & Dining</option>
                    <option value="transport">ğŸš— Transportation</option>
                    <option value="shopping">ğŸ›’ Shopping</option>
                    <option value="entertainment">ğŸ¬ Entertainment</option>
                    <option value="utilities">ğŸ’¡ Bills & Utilities</option>
                    <option value="healthcare">ğŸ¥ Healthcare</option>
                    <option value="other">ğŸ“‹ Other</option>
                  </select>
                </div>
                <div class="form-control">
                  <label for="export-type-filter">Type</label>
                  <select id="export-type-filter">
                    <option value="all">All Types</option>
                    <option value="income">ğŸ’° Income Only</option>
                    <option value="expense">ğŸ’¸ Expenses Only</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Preview -->
            <div class="export-preview-section">
              <h4>Export Preview</h4>
              <div class="export-preview" id="export-preview">
                <div class="export-preview-loading">Loading preview...</div>
              </div>
            </div>
          </div>

          <div class="export-modal-footer">
            <button type="button" class="btn-cancel" id="export-cancel-btn">Cancel</button>
            <button type="button" class="btn-submit" id="export-submit-btn">
              <i class="fas fa-download"></i> Export
            </button>
          </div>
        </div>
      </div>

      <!-- Add Transaction Form -->
      <div class="form-section">
        <h3><i class="fas fa-plus-circle"></i> Add New Transaction</h3>
        <form id="form" class="transaction-form">
          <div class="form-row">
            <div class="form-control">
              <label for="text">Description</label>
              <input type="text" id="text" placeholder="Enter transaction description" required />
            </div>
            <div class="form-control">
              <label for="category">Category <span id="category-confidence" class="confidence-badge hidden"></span></label>
              <select id="category" required>
                <option value="">Select Category</option>
                <option value="food">ğŸ½ï¸ Food & Dining</option>
                <option value="transport">ğŸš— Transportation</option>
                <option value="shopping">ğŸ›’ Shopping</option>
                <option value="entertainment">ğŸ¬ Entertainment</option>
                <option value="bills">ğŸ’¡ Bills & Utilities</option>
                <option value="healthcare">ğŸ¥ Healthcare</option>
                <option value="education">ğŸ“š Education</option>
                <option value="travel">âœˆï¸ Travel</option>
                <option value="salary">ğŸ’¼ Salary</option>
                <option value="freelance">ğŸ’» Freelance</option>
                <option value="investment">ğŸ“ˆ Investment</option>
                <option value="other">ğŸ“‹ Other</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-control">
              <label for="amount">Amount</label>
              <input type="number" id="amount" placeholder="Enter amount" step="0.01" required>
              <small>Tip: Use negative values for expenses, positive for income</small>
            </div>
            <div class="form-control">
              <label for="currency">Currency</label>
              <select id="currency" required>
                <option value="">Loading currencies...</option>
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-control">
              <label for="type">Transaction Type</label>
              <select id="type" required>
                <option value="">Select Type</option>
                <option value="income">ğŸ’° Income</option>
                <option value="expense">ğŸ’¸ Expense</option>
              </select>
            </div>
            <div class="form-control"></div>
          </div>
          <button type="submit" class="btn-submit">
            <i class="fas fa-plus"></i>
            Add Transaction
          </button>
        </form>
      </div>

      <!-- AI-Driven Budget Intelligence Dashboard -->
      <div class="intelligence-section" id="intelligence-dashboard">
        <div class="section-header">
          <h3><i class="fas fa-brain"></i> AI Budget Intelligence</h3>
          <div class="intelligence-controls">
            <button class="refresh-btn" id="refresh-intelligence" title="Refresh Intelligence Data">
              <i class="fas fa-sync-alt"></i>
            </button>
          </div>
        </div>

        <!-- Intelligence Loading Indicator -->
        <div class="intelligence-loader" id="intelligence-loader">
          <div class="loader-spinner"></div>
          <span>Analyzing spending patterns...</span>
        </div>

        <!-- Summary Cards -->
        <div id="intelligence-summary"></div>

        <!-- Intelligence Tabs -->
        <div class="intelligence-tabs">
          <button class="intelligence-tab active" data-tab="anomalies">
            <i class="fas fa-exclamation-triangle"></i> Anomalies
          </button>
          <button class="intelligence-tab" data-tab="volatility">
            <i class="fas fa-chart-line"></i> Volatility
          </button>
          <button class="intelligence-tab" data-tab="reallocations">
            <i class="fas fa-exchange-alt"></i> Reallocations
          </button>
          <button class="intelligence-tab" data-tab="alerts">
            <i class="fas fa-bell"></i> Alerts
          </button>
          <button class="intelligence-tab" data-tab="budgets">
            <i class="fas fa-wallet"></i> Budgets
          </button>
        </div>

        <!-- Tab Panels -->
        <div class="intelligence-panels">
          <div class="intelligence-panel active" id="anomalies-panel">
            <h4>Z-Score Anomaly Detection</h4>
            <p class="panel-description">Transactions flagged with Z-Score â‰¥ 2.0 (statistically unusual spending)</p>
            <div id="anomaly-timeline"></div>
          </div>

          <div class="intelligence-panel" id="volatility-panel">
            <h4>Spending Volatility Analysis</h4>
            <p class="panel-description">Category volatility index based on coefficient of variation</p>
            <div id="volatility-chart"></div>
          </div>

          <div class="intelligence-panel" id="reallocations-panel">
            <h4>Self-Healing Budget Suggestions</h4>
            <p class="panel-description">AI-suggested fund transfers from surplus to deficit categories</p>
            <div id="reallocation-suggestions"></div>
          </div>

          <div class="intelligence-panel" id="alerts-panel">
            <h4>Budget Alerts</h4>
            <p class="panel-description">AI-driven alerts including predictions and anomaly warnings</p>
            <div id="intelligence-alerts"></div>
          </div>

          <div class="intelligence-panel" id="budgets-panel">
            <h4>Budget Intelligence Overview</h4>
            <p class="panel-description">Budgets with AI-enhanced statistics and predictions</p>
            <div id="budget-intelligence-list"></div>
          </div>
        </div>

        <!-- Transaction Analyzer -->
        <div class="transaction-analyzer">
          <h4><i class="fas fa-search-dollar"></i> Analyze Transaction</h4>
          <form id="analyze-transaction-form" class="analyze-form">
            <div class="analyze-row">
              <input type="number" name="amount" placeholder="Amount" step="0.01" min="0.01" required>
              <select name="category" required>
                <option value="">Select Category</option>
                <option value="food">Food & Dining</option>
                <option value="transport">Transportation</option>
                <option value="shopping">Shopping</option>
                <option value="entertainment">Entertainment</option>
                <option value="bills">Bills & Utilities</option>
                <option value="healthcare">Healthcare</option>
                <option value="other">Other</option>
              </select>
              <input type="text" name="description" placeholder="Description (optional)">
              <button type="submit" class="analyze-btn">
                <i class="fas fa-microscope"></i> Analyze
              </button>
            </div>
          </form>
          <div id="analysis-result"></div>
        </div>
      </div>

      <!-- Recurring Expenses Section -->
      <div class="recurring-section" id="recurring-section">
        <div class="section-header">
          <h3><i class="fas fa-sync-alt"></i> Recurring Expenses & Subscriptions</h3>
          <button class="add-recurring-btn" id="add-recurring-btn">
            <i class="fas fa-plus"></i> Add Recurring
          </button>
        </div>

        <!-- Recurring Statistics -->
        <div class="recurring-stats" id="recurring-stats">
          <!-- Stats will be rendered here -->
        </div>

        <!-- Recurring Expenses List -->
        <div class="recurring-list" id="recurring-list">
          <!-- Recurring expenses will be rendered here -->
        </div>
      </div>

      <!-- Recurring Expense Modal -->
      <div class="recurring-modal" id="recurring-modal">
        <div class="recurring-modal-content">
          <div class="recurring-modal-header">
            <h3 id="recurring-modal-title">Add Recurring Expense</h3>
            <button class="modal-close-btn" id="recurring-modal-close">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <form id="recurring-form" class="recurring-form">
            <input type="hidden" id="recurring-id">

            <div class="form-row">
              <div class="form-control">
                <label for="recurring-description">Description *</label>
                <input type="text" id="recurring-description" placeholder="e.g., Netflix Subscription" required>
              </div>
              <div class="form-control">
                <label for="recurring-amount">Amount (â‚¹) *</label>
                <input type="number" id="recurring-amount" placeholder="499.00" step="0.01" min="0.01" required>
              </div>
            </div>

            <div class="form-row">
              <div class="form-control">
                <label for="recurring-category">Category *</label>
                <select id="recurring-category" required>
                  <option value="">Select Category</option>
                  <option value="subscription">ğŸ“º Subscription</option>
                  <option value="rent">ğŸ  Rent</option>
                  <option value="insurance">ğŸ›¡ï¸ Insurance</option>
                  <option value="utilities">ğŸ’¡ Utilities</option>
                  <option value="entertainment">ğŸ¬ Entertainment</option>
                  <option value="food">ğŸ½ï¸ Food</option>
                  <option value="transport">ğŸš— Transport</option>
                  <option value="healthcare">ğŸ¥ Healthcare</option>
                  <option value="shopping">ğŸ›’ Shopping</option>
                  <option value="other">ğŸ“‹ Other</option>
                </select>
              </div>
              <div class="form-control">
                <label for="recurring-type">Type *</label>
                <select id="recurring-type" required>
                  <option value="expense">ğŸ’¸ Expense</option>
                  <option value="income">ğŸ’° Income</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="form-control">
                <label for="recurring-frequency">Frequency *</label>
                <select id="recurring-frequency" required>
                  <option value="monthly">Monthly</option>
                  <option value="weekly">Weekly</option>
                  <option value="biweekly">Bi-weekly</option>
                  <option value="daily">Daily</option>
                  <option value="quarterly">Quarterly</option>
                  <option value="yearly">Yearly</option>
                </select>
              </div>
              <div class="form-control">
                <label for="recurring-reminder-days">Remind Before (days)</label>
                <input type="number" id="recurring-reminder-days" value="3" min="0" max="30">
              </div>
            </div>

            <div class="form-row">
              <div class="form-control">
                <label for="recurring-start-date">Start Date *</label>
                <input type="date" id="recurring-start-date" required>
              </div>
              <div class="form-control">
                <label for="recurring-next-due">Next Due Date *</label>
                <input type="date" id="recurring-next-due" required>
              </div>
            </div>

            <div class="form-row">
              <div class="form-control">
                <label for="recurring-end-date">End Date (optional)</label>
                <input type="date" id="recurring-end-date">
              </div>
              <div class="form-control checkbox-control">
                <label class="checkbox-label">
                  <input type="checkbox" id="recurring-auto-create" checked>
                  <span class="checkmark"></span>
                  Auto-create expense on due date
                </label>
              </div>
            </div>

            <div class="form-control full-width">
              <label for="recurring-notes">Notes (optional)</label>
              <textarea id="recurring-notes" rows="3" placeholder="Add any notes..."></textarea>
            </div>

            <div class="modal-actions">
              <button type="button" class="btn-cancel" id="recurring-cancel-btn">Cancel</button>
              <button type="submit" class="btn-submit">
                <i class="fas fa-save"></i> Save
              </button>
            </div>
          </form>
        </div>
      </div>
    </div> <!-- End #protectedContent -->
      </main>


     <!-- Footer -->
 <footer class="footer" role="contentinfo">
  <div class="footer-container">

    <div class="footer-section">
      <div class="footer-logo">
        <i class="fas fa-wallet"></i>
        <span>ExpenseFlow</span>
      </div>

      <p class="footer-description">
        Smart money management made simple. Track, analyze, and optimize your financial habits.
      </p>

      <div class="social-links">
        <a href="https://x.com/9504_renu" class="social-link" target="_blank" rel="noopener noreferrer" aria-label="X (Twitter)">
          <i class="fab fa-x-twitter"></i>
        </a>
        <a href="https://github.com/Renu-code123/ExpenseFlow" class="social-link" target="_blank" rel="noopener noreferrer" aria-label="GitHub">
          <i class="fab fa-github"></i>
        </a>
        <a href="mailto:renu89857@gmail.com" class="social-link" aria-label="Email">
          <i class="far fa-envelope"></i>
        </a>
        <a href="https://www.linkedin.com/in/renu-kumari-prajapati" class="social-link" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </div>
    </div>

    <div class="footer-section">
      <h4>Company</h4>
      <ul class="footer-links">
        <li><a href="index.html" class="public">Dashboard</a></li>
        <li><a href="public/PrivacyPolicy.html" class="public-link">Privacy Policy</a></li>
        <li><a href="public/terms_service.html" class="public-link">Terms of Service</a></li>
        <li><a href="mailto:renu89857@gmail.com" class="public">Contact</a></li>
      </ul>
    </div>
  </div>

  <div class="footer-bottom">
    <div class="footer-container">
      <p>&copy; 2026 ExpenseFlow. All rights reserved. Made with â¤ï¸ for better financial management.</p>
      <div class="footer-stats">
        <span>ğŸ† Trusted by 10,000+ users</span>
        <span>ğŸ’° â‚¹50M+ tracked</span>
        <span>ğŸ“Š 99.9% uptime</span>
      </div>
    </div>
  </div>
</footer>

  <!-- Currency Settings Modal -->
  <div id="currency-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="fas fa-money-bill-wave"></i> Currency Settings</h3>
        <span class="close-modal" onclick="closeCurrencyModal()">&times;</span>
      </div>
      <div class="modal-body">
        <div class="form-control">
          <label for="preferred-currency">Preferred Currency</label>
          <select id="preferred-currency" class="currency-select">
            <option value="">Loading currencies...</option>
          </select>
          <small>All expenses will be converted to this currency for display</small>
        </div>
        <div class="form-control">
          <label>Exchange Rate Info</label>
          <div class="exchange-rate-info" id="exchange-rate-info">
            <p>Select a currency to see current exchange rates</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-cancel" onclick="closeCurrencyModal()">Cancel</button>
        <button class="btn-submit" onclick="saveCurrencyPreference()">Save Settings</button>
      </div>
    </div>
  </div>

 
  <!-- Authentication working properly now -->
  <!-- All required scripts will be inline -->

  <!-- PWA Installation Prompt -->
  <div id="install-prompt" class="install-prompt" style="display: none;">
    <div class="install-prompt-content">
      <div class="install-prompt-header">
        <i class="fas fa-download"></i>
        <h3>Install ExpenseFlow</h3>
      </div>
      <p>Install ExpenseFlow for quick access and offline functionality!</p>
      <div class="install-prompt-actions">
        <button id="install-button" class="install-btn">
          <i class="fas fa-plus"></i> Install
        </button>
        <button id="install-dismiss" class="dismiss-btn">
          <i class="fas fa-times"></i> Not now
        </button>
      </div>
    </div>
  </div>

  <!-- Offline Indicator -->
  <div id="offline-indicator" class="offline-indicator" style="display: none;">
    <i class="fas fa-wifi-slash"></i>
    <span>You're offline. Changes will be saved locally.</span>
  </div>

  <!-- Update Available Notification -->
  <div id="update-notification" class="update-notification" style="display: none;">
    <div class="update-content">
      <i class="fas fa-sync-alt"></i>
      <span>A new version is available!</span>
      <button id="update-button" class="update-btn">Update Now</button>
    </div>
  </div>
  <script>
// Wait for page to load
window.addEventListener("DOMContentLoaded", () => {
  const toggleBtn = document.getElementById("theme-toggle-btn");
  const body = document.body;

  // Load saved theme from localStorage
  const savedTheme = localStorage.getItem("theme");
  if (savedTheme === "dark") {
    body.classList.add("dark-theme");
    toggleBtn.textContent = "â˜€ï¸"; // change icon for dark
  }

  // Toggle dark/light mode
  toggleBtn.addEventListener("click", () => {
    body.classList.toggle("dark-theme");

    const isDark = body.classList.contains("dark-theme");
    toggleBtn.textContent = isDark ? "â˜€ï¸" : "ğŸŒ™";

    // Save preference
    localStorage.setItem("theme", isDark ? "dark" : "light");
  });
});
</script>

  <!-- Chatbot -->


    <!-- Chatbot Widget -->
    <div id="chatbot-container" class="chatbot-container">
      <div id="chatbot-widget" class="chatbot-widget">
        <!-- Chat Header -->
        <div class="chatbot-header">
          <div class="chatbot-header-content">
            <h3>ExpenseFlow Assistant</h3>
            <p>Ask me anything about your finances</p>
          </div>
          <button id="chatbot-close" class="chatbot-close-btn">
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <!-- Chat Messages -->
        <div id="chatbot-messages" class="chatbot-messages">
          <div class="chatbot-message bot-message">
            <div class="message-content">
              <p>Hi! ğŸ‘‹ I'm your ExpenseFlow Assistant. How can I help you manage your finances today?</p>
            </div>
          </div>
        </div>
        
        <!-- Chat Input -->
        <div class="chatbot-input-area">
          <form id="chatbot-form" class="chatbot-form">
            <input 
              type="text" 
              id="chatbot-input" 
              class="chatbot-input" 
              placeholder="Type your message..." 
              autocomplete="off"
            >
            <button type="submit" class="chatbot-send-btn">
              <i class="fas fa-paper-plane"></i>
            </button>
          </form>
        </div>
      </div>
      
      <!-- Chat Toggle Button -->
      <button id="chatbot-toggle" class="chatbot-toggle-btn" title="Chat with Assistant">
        <i class="fas fa-comments"></i>
      </button>
    </div> <!-- End #chatbot-container -->

    <!-- Authentication Prompt for Unauthenticated Users (Premium) -->
    <div id="authPrompt" class="auth-prompt">
      <div class="auth-prompt-content">
        <div class="auth-prompt-icon">
          <i class="fas fa-shield-halved"></i>
        </div>
        <h2>Unlock ExpenseFlow</h2>
        <p>Your journey to financial freedom starts here. Sign in to access smart analytics, personalized goals, and secure tracking.</p>
        
        <div class="auth-prompt-buttons">
          <button class="auth-prompt-btn primary" onclick="openLoginModal()">
            <i class="fas fa-sign-in-alt"></i>
            Login Now
          </button>
          <button class="auth-prompt-btn secondary" onclick="openSignupModal()">
            <i class="fas fa-user-plus"></i>
            Get Started
          </button>
        </div>
        
        <div class="auth-prompt-features">
          <h4>Premium Features:</h4>
          <ul>
            <li><i class="fas fa-check-circle"></i> Smart Tracking</li>
            <li><i class="fas fa-check-circle"></i> Budget Planning</li>
            <li><i class="fas fa-check-circle"></i> Cloud Sync</li>
            <li><i class="fas fa-check-circle"></i> Data Export</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Login Modal Overlay -->
    <div id="loginModal" class="login-modal-overlay">
      <div class="login-modal">
        <button class="login-modal-close" onclick="closeLoginModal()">
          <i class="fas fa-times"></i>
        </button>
        <div class="login-modal-content">
          <div style="text-align:center; font-size:2rem; margin-bottom:0.5rem;">
            <i class="fas fa-lock"></i>
          </div>
          <h2>Login to ExpenseFlow</h2>
          <form id="loginFormModal">
            <div class="form-group">
              <label for="loginEmailModal">Email:</label>
              <input type="email" id="loginEmailModal" required placeholder="Enter your email">
            </div>
            <div class="form-group">
              <label for="loginPasswordModal">Password:</label>
              <input type="password" id="loginPasswordModal" required placeholder="Enter your password">
            </div>
            <button type="submit" class="login-btn">Login</button>
            <p class="login-signup-link">
              Don't have an account? 
              <a href="javascript:void(0)" onclick="switchToSignup()">Sign up here</a>
            </p>
          </form>
        </div>
      </div>
    </div>

    <!-- Signup Modal Overlay -->
    <div id="signupModal" class="login-modal-overlay">
      <div class="login-modal">
        <button class="login-modal-close" onclick="closeSignupModal()">
          <i class="fas fa-times"></i>
        </button>
        <div class="login-modal-content">
          <div style="text-align:center; font-size:2rem; margin-bottom:0.5rem;">
            <i class="fas fa-user-plus"></i>
          </div>
          <h2>Sign Up for ExpenseFlow</h2>
          <form id="signupFormModal">
            <div class="form-group">
              <label for="signupUsernameModal">Username:</label>
              <input type="text" id="signupUsernameModal" required placeholder="Choose a username">
            </div>
            <div class="form-group">
              <label for="signupEmailModal">Email:</label>
              <input type="email" id="signupEmailModal" required placeholder="Enter your email">
            </div>
            <div class="form-group">
              <label for="signupPasswordModal">Password:</label>
              <input type="password" id="signupPasswordModal" required placeholder="Create a password">
            </div>
            <button type="submit" class="login-btn">Sign Up</button>
            <p class="login-signup-link">
              Already have an account? 
              <a href="javascript:void(0)" onclick="switchToLogin()">Login here</a>
            </p>
          </form>
        </div>
      </div>
    </div>



    <script>
      // Mobile Navigation Toggle
      document.addEventListener('DOMContentLoaded', function() {
        const navToggle = document.getElementById('nav-toggle');
        const navMenu = document.getElementById('nav-menu');
        const navLinks = document.querySelectorAll('.nav-link');
        
        if (navToggle) {
          navToggle.addEventListener('click', function() {
            navToggle.classList.toggle('active');
            navMenu.classList.toggle('active');
          });
        }
        
        // Close mobile menu when clicking on a link
        navLinks.forEach(link => {
          link.addEventListener('click', () => {
            navToggle.classList.remove('active');
            navMenu.classList.remove('active');
            
            // Update active state
            navLinks.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
          });
        });
        
        // Close menu when clicking outside
        document.addEventListener('click', (event) => {
          const isClickInsideNav = navMenu.contains(event.target) || navToggle.contains(event.target);
          if (!isClickInsideNav && navMenu.classList.contains('active')) {
            navToggle.classList.remove('active');
            navMenu.classList.remove('active');
          }
        });

        // Authentication State Management - Initialize first
        initializeAuthSystem();
        
        // Chatbot Functionality
        initializeChatbot();
      });

      // =========================
      // LOGIN MODAL FUNCTIONALITY
      // =========================

      function openLoginModal() {
        console.log('Opening login modal...');
        const modal = document.getElementById('loginModal');
        const authPrompt = document.getElementById('authPrompt');
        
        console.log('Modal element found:', !!modal);
        console.log('Auth prompt found:', !!authPrompt);
        
        if (modal) {
          // Hide auth prompt when opening modal
          if (authPrompt) {
            authPrompt.classList.remove('show');
            console.log('Auth prompt hidden');
          }
          
          modal.classList.add('active');
          document.body.classList.add('modal-active');
          
          console.log('Modal classes after opening:', modal.className);
          console.log('Body classes after opening:', document.body.className);
          
          // Focus on email input
          setTimeout(() => {
            const emailInput = document.getElementById('loginEmailModal');
            if (emailInput) emailInput.focus();
          }, 300);
        } else {
          console.error('Login modal element not found!');
          alert('Login modal not found! Check console for details.');
        }
      }

      function closeLoginModal() {
        const modal = document.getElementById('loginModal');
        const authPrompt = document.getElementById('authPrompt');
        if (modal) {
          modal.classList.remove('active');
          document.body.classList.remove('modal-active');
          
          // Show auth prompt again if user is not authenticated
          const token = localStorage.getItem('authToken');
          if (!token && authPrompt) {
            setTimeout(() => authPrompt.classList.add('show'), 300);
          }
        }
      }

      function openSignupModal() {
        const modal = document.getElementById('signupModal');
        const authPrompt = document.getElementById('authPrompt');
        if (modal) {
          // Hide auth prompt when opening modal
          if (authPrompt) authPrompt.classList.remove('show');
          
          modal.classList.add('active');
          document.body.classList.add('modal-active');
          // Focus on username input
          setTimeout(() => {
            const usernameInput = document.getElementById('signupUsernameModal');
            if (usernameInput) usernameInput.focus();
          }, 300);
        }
      }

      function closeSignupModal() {
        const modal = document.getElementById('signupModal');
        const authPrompt = document.getElementById('authPrompt');
        if (modal) {
          modal.classList.remove('active');
          document.body.classList.remove('modal-active');
          
          // Show auth prompt again if user is not authenticated
          const token = localStorage.getItem('authToken');
          if (!token && authPrompt) {
            setTimeout(() => authPrompt.classList.add('show'), 300);
          }
        }
      }

      function switchToSignup() {
        closeLoginModal();
        setTimeout(() => openSignupModal(), 100);
      }

      function switchToLogin() {
        closeSignupModal();
        setTimeout(() => openLoginModal(), 100);
      }

      // Close modal when clicking outside
      document.addEventListener('click', (event) => {
        const loginModal = document.getElementById('loginModal');
        const signupModal = document.getElementById('signupModal');
        
        if (loginModal && loginModal.classList.contains('active')) {
          if (event.target === loginModal) {
            closeLoginModal();
          }
        }
        
        if (signupModal && signupModal.classList.contains('active')) {
          if (event.target === signupModal) {
            closeSignupModal();
          }
        }
      });

      // Close modal on Escape key
      document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape') {
          closeLoginModal();
          closeSignupModal();
        }
      });

      // Handle Login Form Submission
      document.addEventListener('DOMContentLoaded', function() {
        const loginForm = document.getElementById('loginFormModal');
        const signupForm = document.getElementById('signupFormModal');

        if (loginForm) {
          loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('loginEmailModal').value.trim();
            const password = document.getElementById('loginPasswordModal').value.trim();
            
            if (!email || !password) {
              showNotification('Please fill in all fields', 'error');
              return;
            }
            
            try {
              // Simulate login API call (replace with actual authentication)
              const response = await fetch('/api/auth/login', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email, password }),
              });
              
              if (response.ok) {
                const data = await response.json();
                localStorage.setItem('authToken', data.token);
                localStorage.setItem('userInfo', JSON.stringify(data.user));
                
                showNotification('Login successful! Welcome back.', 'success');
                closeLoginModal();
                updateAuthState(true, data.user);
              } else {
                const error = await response.json();
                showNotification(error.message || 'Login failed', 'error');
              }
            } catch (error) {
              console.error('Login error:', error);
              showNotification('Connection error. Please try again.', 'error');
            }
          });
        }

        if (signupForm) {
          signupForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const username = document.getElementById('signupUsernameModal').value.trim();
            const email = document.getElementById('signupEmailModal').value.trim();
            const password = document.getElementById('signupPasswordModal').value.trim();
            
            if (!username || !email || !password) {
              showNotification('Please fill in all fields', 'error');
              return;
            }
            
            try {
              // Simulate signup API call (replace with actual registration)
              const response = await fetch('/api/auth/register', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                },
                body: JSON.stringify({ username, email, password }),
              });
              
              if (response.ok) {
                const data = await response.json();
                localStorage.setItem('authToken', data.token);
                localStorage.setItem('userInfo', JSON.stringify(data.user));
                
                showNotification('Registration successful! Welcome to ExpenseFlow.', 'success');
                closeSignupModal();
                updateAuthState(true, data.user);
              } else {
                const error = await response.json();
                showNotification(error.message || 'Registration failed', 'error');
              }
            } catch (error) {
              console.error('Signup error:', error);
              showNotification('Connection error. Please try again.', 'error');
            }
          });
        }
      });

      // Authentication System Initialization
      function initializeAuthSystem() {
        console.log('Initializing authentication system...');
        checkAuthState();
      }
      
      // Authentication State Management
      function checkAuthState() {
        const token = localStorage.getItem('authToken');
        const userInfo = localStorage.getItem('userInfo');
        
        if (token && userInfo) {
          try {
            const user = JSON.parse(userInfo);
            updateAuthState(true, user);
          } catch (error) {
            console.error('Error parsing user info:', error);
            logout();
          }
        } else {
          updateAuthState(false);
          // Do NOT force auth prompt on load
        }
      }

      function updateAuthState(isLoggedIn, user = null) {
        const authButtons = document.getElementById('authButtons');
        const userInfo = document.getElementById('userInfo');
        const protectedElements = document.querySelectorAll('.protected-content');
        const navLinks = document.querySelectorAll('.nav-link');
        
        if (isLoggedIn && user) {
          // Show user info, hide auth buttons
          if (authButtons) authButtons.style.display = 'none';
          if (userInfo) {
            userInfo.style.display = 'flex';
            const username = userInfo.querySelector('.username');
            if (username) username.textContent = user.username || user.name || user.email;
          }
          
          // Enable protected content
          protectedElements.forEach(element => {
            element.style.display = '';
            element.style.pointerEvents = 'auto';
            element.style.opacity = '1';
          });
          
          // Enable navigation links
          navLinks.forEach(link => {
            link.style.pointerEvents = 'auto';
            link.style.opacity = '1';
            link.removeAttribute('disabled');
          });
          
          // Hide auth prompt
          hideAuthPrompt();
        } else {
          if (authButtons) authButtons.style.display = 'flex';
          if (userInfo) userInfo.style.display = 'none';

          // Hide protected content only
          // Visually lock protected content instead of removing it
        protectedElements.forEach(element => {
          element.style.pointerEvents = 'none';
          element.style.opacity = '0.35';
          element.style.filter = 'blur(1px)';
        });

        // Disable ONLY non-public nav links
        navLinks.forEach(link => {
          if (link.classList.contains('public')) {
            link.style.pointerEvents = 'auto';
            link.style.opacity = '1';
          } else {
            link.style.pointerEvents = 'auto';
            link.style.opacity = '0.6';
        link.removeEventListener('click', handleUnauthorizedClick);
        link.addEventListener('click', handleUnauthorizedClick);
          }
        });
      }

      function logout() {
        localStorage.removeItem('authToken');
        localStorage.removeItem('userInfo');
        updateAuthState(false);
        showNotification('Logged out successfully', 'info');
      }

      function showNotification(message, type = 'info') {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        notification.innerHTML = `
          <div class="notification-content">
            <i class="fas ${getNotificationIcon(type)}"></i>
            <span>${message}</span>
          </div>
          <button class="notification-close" onclick="this.parentElement.remove()">
            <i class="fas fa-times"></i>
          </button>
        `;
        
        // Add to page
        document.body.appendChild(notification);
        
        // Show notification
        setTimeout(() => notification.classList.add('show'), 100);
        
        // Auto remove after 5 seconds
        setTimeout(() => {
          if (notification.parentElement) {
            notification.classList.remove('show');
            setTimeout(() => notification.remove(), 300);
          }
        }, 5000);
      }

      function getNotificationIcon(type) {
        switch (type) {
          case 'success': return 'fa-check-circle';
          case 'error': return 'fa-exclamation-triangle';
          case 'warning': return 'fa-exclamation-circle';
          default: return 'fa-info-circle';
        }
      }
      
      // Handle unauthorized access attempts
      function handleUnauthorizedClick(e) {
        const link = e.currentTarget;
      
        // Allow public links (footer/legal)
        if (
          link.classList.contains("public") ||
          link.classList.contains("public-link") ||
          link.closest("footer")
        ) {
          return;
        }
      
        e.preventDefault();
        e.stopPropagation();
        showNotification("Please login to access this feature", "warning");
        openLoginModal();
      }

      // Show authentication prompt
      function showAuthPrompt() {
        const authPrompt = document.getElementById('authPrompt');
        if (authPrompt) {
          authPrompt.classList.add('show');
        }
      }
      
      // Hide authentication prompt
      function hideAuthPrompt() {
        const authPrompt = document.getElementById('authPrompt');
        if (authPrompt) {
          authPrompt.classList.remove('show');
        }
      }

      // Debug function to test modal visibility
      function testModal() {
        console.log('=== MODAL DEBUG ===');
        const loginModal = document.getElementById('loginModal');
        const authPrompt = document.getElementById('authPrompt');
        const authButtons = document.getElementById('authButtons');
        
        console.log('Login Modal:', loginModal);
        console.log('Auth Prompt:', authPrompt);
        console.log('Auth Buttons:', authButtons);
        
        if (loginModal) {
          console.log('Modal classes:', loginModal.className);
          const computed = window.getComputedStyle(loginModal);
          console.log('Modal computed:', {
            display: computed.display,
            visibility: computed.visibility,
            opacity: computed.opacity,
            zIndex: computed.zIndex
          });
          
          // Force show modal for testing
          loginModal.classList.add('active');
          document.body.classList.add('modal-active');
          loginModal.style.zIndex = '9999';
          loginModal.style.display = 'flex';
          loginModal.style.visibility = 'visible';
          loginModal.style.opacity = '1';
          
          console.log('Forced modal visibility - classes:', loginModal.className);
        }
        
        if (authPrompt) {
          console.log('Auth prompt classes:', authPrompt.className);
          const computed = window.getComputedStyle(authPrompt);
          console.log('Auth prompt computed:', {
            display: computed.display,
            visibility: computed.visibility,
            opacity: computed.opacity
          });
        }
        
        alert('Check console for detailed modal debug info. Modal should now be visible.');
      }

      // =========================
      // END LOGIN MODAL FUNCTIONALITY
      // =========================

      function initializeChatbot() {
        const chatbotToggle = document.getElementById('chatbot-toggle');
        const chatbotWidget = document.getElementById('chatbot-widget');
        const chatbotForm = document.getElementById('chatbot-form');
        const chatbotInput = document.getElementById('chatbot-input');
        const chatbotMessages = document.getElementById('chatbot-messages');
        const chatbotClose = document.getElementById('chatbot-close');

        // Toggle chatbot window
        chatbotToggle.addEventListener('click', () => {
          chatbotWidget.classList.toggle('active');
          if (chatbotWidget.classList.contains('active')) {
            chatbotToggle.classList.add('hidden');
            chatbotInput.focus();
          } else {
            chatbotToggle.classList.remove('hidden');
          }
        });

        // Close chatbot window
        chatbotClose.addEventListener('click', () => {
          chatbotWidget.classList.remove('active');
          chatbotToggle.classList.remove('hidden');
        });

        // Handle form submission
        chatbotForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const message = chatbotInput.value.trim();
          
          if (message) {
            // Add user message
            addMessage(message, 'user');
            chatbotInput.value = '';
            
            // Simulate bot response
            setTimeout(() => {
              const response = getBotResponse(message);
              addMessage(response, 'bot');
            }, 500);
          }
        });

        function addMessage(text, sender) {
          const messageDiv = document.createElement('div');
          messageDiv.className = `chatbot-message ${sender}-message`;
          
          const contentDiv = document.createElement('div');
          contentDiv.className = 'message-content';
          
          const p = document.createElement('p');
          p.textContent = text;
          
          contentDiv.appendChild(p);
          messageDiv.appendChild(contentDiv);
          
          chatbotMessages.appendChild(messageDiv);
          
          // Auto scroll to bottom
          chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
        }

        function getBotResponse(userMessage) {
          const lowerMessage = userMessage.toLowerCase();
          
          // Expense-related responses
          if (lowerMessage.includes('add') && (lowerMessage.includes('expense') || lowerMessage.includes('transaction'))) {
            return "You can add an expense by scrolling down to the 'Add New Transaction' form. Fill in the description, amount, category, and date, then click submit! ğŸ“";
          }
          
          if (lowerMessage.includes('budget')) {
            return "Budget planning is a great way to manage your spending! You can set budget goals by category to track your spending limits. Would you like tips on creating an effective budget? ğŸ’°";
          }
          
          if (lowerMessage.includes('goal') || lowerMessage.includes('savings')) {
            return "Setting financial goals helps you stay motivated! You can create short-term and long-term goals to work towards your financial dreams. What's your goal? ğŸ¯";
          }
          
          if (lowerMessage.includes('category')) {
            return "We support many categories including: Food, Transportation, Shopping, Entertainment, Bills, Healthcare, Education, Travel, Salary, Freelance, Investment, and more! Pick what works for you. ğŸ“‚";
          }
          
          if (lowerMessage.includes('receipt')) {
            return "You can upload receipts to verify your expenses! This helps you keep accurate records and track your spending better. Perfect for important purchases! ğŸ“¸";
          }
          
          if (lowerMessage.includes('sync') || lowerMessage.includes('offline')) {
            return "ExpenseFlow works offline and syncs your data when you're back online! Your data is always safe and accessible. No worries about losing your information! ğŸ”„";
          }
          
          if (lowerMessage.includes('delete') || lowerMessage.includes('edit')) {
            return "You can edit or delete transactions from your history. Just click on any transaction to modify it or remove it. Easy management! âœï¸";
          }
          
          if (lowerMessage.includes('help') || lowerMessage.includes('how')) {
            return "I'm here to help! You can ask me about:\nâ€¢ Adding expenses\nâ€¢ Creating budgets\nâ€¢ Setting goals\nâ€¢ Managing receipts\nâ€¢ Categories\nâ€¢ And more!\n\nWhat would you like to know? ğŸ¤”";
          }
          
          if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
            return "Hey there! ğŸ‘‹ I'm your ExpenseFlow Assistant. How can I help you manage your finances today?";
          }
          
          // Default responses
          const responses = [
            "That's a great question! Feel free to explore ExpenseFlow's features or ask me more about managing your expenses. ğŸ’¡",
            "I'm here to help you manage your finances better! Is there anything specific you'd like to know? ğŸ¤",
            "Thanks for that message! I'm learning to help you even better. Check out the features above or ask me another question! ğŸš€",
            "Interesting! Remember, smart money management is all about tracking and planning. How can I assist you further? ğŸ“Š",
            "I'm always here to help! Feel free to ask me anything about budgeting, expense tracking, or financial planning. ğŸ’¸"
          ];
          
          return responses[Math.floor(Math.random() * responses.length)];
        }
      }
    </script>
    
    <!-- Scroll to Top Button -->
    <button id="scrollToTopBtn" class="scroll-to-top" aria-label="Scroll to top">
      <i class="fas fa-arrow-up"></i>
    </button>
    <script>
      // Scroll to Top Button - Home Page Only
      document.addEventListener("DOMContentLoaded", function () {
        const scrollBtn = document.getElementById("scrollToTopBtn");
      
        if (!scrollBtn) return;
      
        window.addEventListener("scroll", () => {
          if (window.scrollY > 300) {
            scrollBtn.classList.add("show");
          } else {
            scrollBtn.classList.remove("show");
          }
        });
      
        scrollBtn.addEventListener("click", () => {
          window.scrollTo({
            top: 0,
            behavior: "smooth"
          });
        });
      });
    </script>
  </body>
</html>